# å˜æ›´è®°å½• (Changelog)

## [2025-01-22] - æ¶æ„åˆ†æå®Œæˆ

### æœ¬æ¬¡æ¶æ„åˆ†æå†…å®¹
- **ç›®æ ‡**ï¼šå¯¹ Clash è®¢é˜…è½¬æ¢æœåŠ¡é¡¹ç›®è¿›è¡Œå…¨é¢çš„æ¶æ„åˆ†æå’Œé—®é¢˜æ£€æŸ¥
- **èŒƒå›´**ï¼šåç«¯ Python FastAPIã€å‰ç«¯ Vue.jsã€Docker éƒ¨ç½²ã€å®‰å…¨æ€§è¯„ä¼°
- **å®Œæˆåº¦**ï¼šå·²æ·±åº¦æ‰«æåç«¯æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ã€å‰ç«¯ç»„ä»¶æ¶æ„ã€é…ç½®æ–‡ä»¶å’Œéƒ¨ç½²è®¾ç½®

### è¯†åˆ«çš„æ¨¡å—ç»“æ„
- **åç«¯æ ¸å¿ƒ**ï¼š`backend/app/` (FastAPI æ¶æ„ï¼ŒåŒ…å« APIã€æ ¸å¿ƒä¸šåŠ¡ã€æ•°æ®æ¨¡å‹)
- **å‰ç«¯ç•Œé¢**ï¼š`frontend/src/` (Vue.js 3 + TypeScript + Element Plus)
- **éƒ¨ç½²é…ç½®**ï¼š`deploy/` (Dockerã€Nginxã€SystemD æœåŠ¡)
- **æ–‡æ¡£ç³»ç»Ÿ**ï¼š`docs/` (éƒ¨ç½²æŒ‡å—ã€å¸è½½æŒ‡å—ã€ç”Ÿäº§éƒ¨ç½²)

### æ ¸å¿ƒæ¶æ„é—®é¢˜è¯†åˆ«
æœ¬æ¬¡åˆ†æå‘ç°äº†æ¶‰åŠ**å®‰å…¨æ€§**ã€**æ€§èƒ½**ã€**å¯ç»´æŠ¤æ€§**å’Œ**ç¨³å®šæ€§**çš„å¤šä¸ªå…³é”®é—®é¢˜ï¼Œè¯¦ç»†åˆ†ææŠ¥å‘Šå·²åœ¨ä¸»å¯¹è¯ä¸­æä¾›ã€‚

---

# é¡¹ç›®æ„¿æ™¯

åŸºäº FastAPI + Vue.js çš„é«˜æ€§èƒ½ Clash ä»£ç†è®¢é˜…è½¬æ¢æœåŠ¡ï¼Œæ”¯æŒå¤šç§ä»£ç†åè®®è½¬æ¢å’Œè‡ªå®šä¹‰è§„åˆ™é…ç½®ã€‚

## ç›®æ ‡ç‰¹æ€§
- ğŸš€ **å¤šåè®®æ”¯æŒ**: SSã€SSRã€V2Rayã€Trojanã€Hysteriaã€TUICã€WireGuard ç­‰
- ğŸ”§ **çµæ´»é…ç½®**: æ”¯æŒè¿œç¨‹é…ç½®è§„åˆ™ï¼ˆACL4SSRã€Subconverter è§„åˆ™ï¼‰
- ğŸ¯ **èŠ‚ç‚¹ç®¡ç†**: èŠ‚ç‚¹è¿‡æ»¤ã€é‡å‘½åã€æ’åºã€å›½æ—— Emoji è‡ªåŠ¨æ·»åŠ 
- ğŸ“± **ç°ä»£åŒ–ç•Œé¢**: Vue.js 3 + TypeScript + Element Plus å“åº”å¼è®¾è®¡
- ğŸ³ **å®¹å™¨åŒ–éƒ¨ç½²**: Docker + Docker Composeï¼Œæ”¯æŒç”¨æˆ·è‡ªå®šä¹‰ç«¯å£

# æ¶æ„æ€»è§ˆ

## æŠ€æœ¯æ ˆ
- **åç«¯**: Python 3.9+ + FastAPI + Pydantic + HTTPX
- **å‰ç«¯**: Vue.js 3 + TypeScript + Element Plus + Pinia + Vite
- **éƒ¨ç½²**: Docker + Docker Compose + Nginx
- **æ•°æ®æ ¼å¼**: YAML/JSON é…ç½®æ–‡ä»¶ï¼Œå†…å­˜ç¼“å­˜

## æ ¸å¿ƒæ¶æ„æ¨¡å¼
- **åç«¯**: RESTful API + åˆ†å±‚æ¶æ„ (API -> Core -> Models)
- **å‰ç«¯**: ç»„ä»¶åŒ–æ¶æ„ + çŠ¶æ€ç®¡ç† (Pinia)
- **éƒ¨ç½²**: å¾®æœåŠ¡å®¹å™¨åŒ– + åå‘ä»£ç†

# æ¨¡å—ç»“æ„å›¾

```mermaid
graph TD
    A["(æ ¹) Clash è®¢é˜…è½¬æ¢æœåŠ¡"] --> B["backend"];
    A --> C["frontend"];
    A --> D["deploy"];
    A --> E["docs"];
    
    B --> F["app"];
    F --> G["api"];
    F --> H["core"];
    F --> I["models"];
    F --> J["utils"];
    B --> K["tests"];
    
    C --> L["src"];
    L --> M["views"];
    L --> N["stores"];
    L --> O["api"];
    L --> P["utils"];
    
    D --> Q["nginx.conf"];
    D --> R["deploy.sh"];
    D --> S["systemd-services"];
    
    E --> T["deployment_guide.md"];
    E --> U["uninstall_guide.md"];

    click B "./backend/" "æŸ¥çœ‹åç«¯æ¨¡å—"
    click C "./frontend/" "æŸ¥çœ‹å‰ç«¯æ¨¡å—"
    click D "./deploy/" "æŸ¥çœ‹éƒ¨ç½²é…ç½®"
    click E "./docs/" "æŸ¥çœ‹é¡¹ç›®æ–‡æ¡£"
```

# æ¨¡å—ç´¢å¼•

| æ¨¡å—è·¯å¾„ | èŒè´£æè¿° | æŠ€æœ¯æ ˆ | å…¥å£æ–‡ä»¶ |
|---------|----------|--------|----------|
| `backend/` | FastAPI åç«¯æœåŠ¡ï¼Œæä¾›è®¢é˜…è½¬æ¢ API | Python FastAPI | `app/main.py` |
| `frontend/` | Vue.js å‰ç«¯ç•Œé¢ï¼Œç”¨æˆ·äº¤äº’å’Œé…ç½®ç®¡ç† | Vue.js 3 + TypeScript | `src/main.ts` |
| `deploy/` | éƒ¨ç½²é…ç½®å’Œè„šæœ¬ï¼Œæ”¯æŒ Docker å’Œç³»ç»ŸæœåŠ¡ | Shell + Docker + Nginx | `deploy.sh` |
| `docs/` | é¡¹ç›®æ–‡æ¡£ï¼ŒåŒ…æ‹¬éƒ¨ç½²å’Œä½¿ç”¨æŒ‡å— | Markdown | `deployment_guide.md` |
| `backend/app/api/` | API è·¯ç”±å®šä¹‰å’Œè¯·æ±‚å¤„ç† | FastAPI Router | `converter.py` |
| `backend/app/core/` | æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼Œè®¢é˜…è§£æå’Œè½¬æ¢ | Python | `converter.py` |
| `backend/app/models/` | æ•°æ®æ¨¡å‹å®šä¹‰ï¼ŒPydantic Schema | Pydantic | `schemas.py` |
| `frontend/src/views/` | Vue.js é¡µé¢ç»„ä»¶ | Vue.js SFC | `Converter.vue` |
| `frontend/src/stores/` | Pinia çŠ¶æ€ç®¡ç† | Pinia | `converter.ts` |

# è¿è¡Œä¸å¼€å‘

## å¿«é€Ÿå¯åŠ¨

### Docker éƒ¨ç½² (æ¨è)
```bash
# å…‹éš†é¡¹ç›®
git clone <repository-url>
cd subt

# ä½¿ç”¨ä¸€é”®éƒ¨ç½²è„šæœ¬
chmod +x deploy/deploy.sh
./deploy/deploy.sh

# æˆ–è€…æ‰‹åŠ¨ Docker Compose
docker-compose up -d --build
```

### æœ¬åœ°å¼€å‘
```bash
# åç«¯å¼€å‘
cd backend
pip install -r requirements.txt
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000

# å‰ç«¯å¼€å‘
cd frontend
npm install
npm run dev
```

## æœåŠ¡è®¿é—®
- **Web ç•Œé¢**: http://localhost:3000
- **API æ–‡æ¡£**: http://localhost:8000/docs
- **å¥åº·æ£€æŸ¥**: http://localhost:8000/health

## ç¯å¢ƒå˜é‡é…ç½®
```bash
BACKEND_PORT=8000      # åç«¯æœåŠ¡ç«¯å£
FRONTEND_PORT=3000     # å‰ç«¯æœåŠ¡ç«¯å£
NGINX_PORT=80          # Nginx HTTP ç«¯å£
NGINX_HTTPS_PORT=443   # Nginx HTTPS ç«¯å£
LOG_LEVEL=INFO         # æ—¥å¿—çº§åˆ«
```

# æµ‹è¯•ç­–ç•¥

## æµ‹è¯•è¦†ç›–
- **å•å…ƒæµ‹è¯•**: pytest æµ‹è¯•åç«¯æ ¸å¿ƒé€»è¾‘ (`backend/tests/`)
- **é›†æˆæµ‹è¯•**: TestClient æµ‹è¯• API æ¥å£
- **åŠŸèƒ½æµ‹è¯•**: æ‰‹åŠ¨æµ‹è¯•å‰ç«¯ç”¨æˆ·äº¤äº’æµç¨‹

## æµ‹è¯•å‘½ä»¤
```bash
# åç«¯æµ‹è¯•
cd backend
pip install -r test_requirements.txt
pytest

# å‰ç«¯æµ‹è¯• (éœ€è¦é…ç½®)
cd frontend
npm run test
```

## æµ‹è¯•ç­–ç•¥
- **è§£æå™¨æµ‹è¯•**: éªŒè¯å„ç§ä»£ç†åè®®è§£æå‡†ç¡®æ€§
- **è½¬æ¢å™¨æµ‹è¯•**: ç¡®ä¿é…ç½®ç”Ÿæˆçš„æ­£ç¡®æ€§å’Œå…¼å®¹æ€§
- **API æµ‹è¯•**: éªŒè¯æ¥å£åŠŸèƒ½å’Œé”™è¯¯å¤„ç†
- **è¾¹ç•Œæµ‹è¯•**: å¤„ç†å¼‚å¸¸è¾“å…¥å’Œæé™æƒ…å†µ

# ç¼–ç è§„èŒƒ

## åç«¯ (Python)
- **ä»£ç é£æ ¼**: PEP 8ï¼Œä½¿ç”¨ type hints
- **æ–‡æ¡£å­—ç¬¦ä¸²**: Google é£æ ¼ï¼Œè¯¦ç»†æè¿°å‚æ•°å’Œè¿”å›å€¼
- **é”™è¯¯å¤„ç†**: ä½¿ç”¨ try-catch å’Œè‡ªå®šä¹‰å¼‚å¸¸ç±»
- **æ—¥å¿—è®°å½•**: ç»“æ„åŒ–æ—¥å¿—ï¼ŒåŒ…å«ä¸Šä¸‹æ–‡ä¿¡æ¯

## å‰ç«¯ (TypeScript/Vue.js)
- **ç»„ä»¶è§„èŒƒ**: Vue 3 Composition APIï¼Œå•æ–‡ä»¶ç»„ä»¶
- **ç±»å‹å®šä¹‰**: ä¸¥æ ¼çš„ TypeScript ç±»å‹æ£€æŸ¥
- **çŠ¶æ€ç®¡ç†**: Pinia store é›†ä¸­çŠ¶æ€ç®¡ç†
- **æ ·å¼è§„èŒƒ**: SCSS + BEM å‘½åè§„çº¦

## é€šç”¨è§„èŒƒ
- **æäº¤æ¶ˆæ¯**: è¯­ä¹‰åŒ–æäº¤ï¼Œæ¸…æ™°æè¿°å˜æ›´å†…å®¹
- **åˆ†æ”¯ç®¡ç†**: Git Flow å·¥ä½œæµï¼ŒåŠŸèƒ½åˆ†æ”¯å¼€å‘
- **ä»£ç å®¡æŸ¥**: Pull Request å¿…é¡»ç»è¿‡å®¡æŸ¥
- **æ–‡æ¡£åŒæ­¥**: ä»£ç å˜æ›´åŒæ—¶æ›´æ–°ç›¸å…³æ–‡æ¡£

# AI ä½¿ç”¨æŒ‡å¼•

## å¼€å‘åŠ©æ‰‹é…ç½®
æœ¬é¡¹ç›®æ”¯æŒ Claude Code ç­‰ AI ä»£ç åŠ©æ‰‹ï¼Œé…ç½®è¦ç‚¹ï¼š

### é¡¹ç›®ç†è§£è¦ç‚¹
1. **æ¶æ„æ¨¡å¼**: å‰åç«¯åˆ†ç¦»ï¼ŒRESTful API è®¾è®¡
2. **æ ¸å¿ƒä¸šåŠ¡**: ä»£ç†åè®®è§£æ -> èŠ‚ç‚¹è¿‡æ»¤ -> é…ç½®ç”Ÿæˆ
3. **æ•°æ®æµå‘**: è®¢é˜…é“¾æ¥ -> è§£æå™¨ -> è½¬æ¢å™¨ -> Clash é…ç½®
4. **éƒ¨ç½²æ–¹å¼**: Docker å®¹å™¨åŒ–ï¼Œæ”¯æŒå•æœºå’Œåå‘ä»£ç†éƒ¨ç½²

### å¼€å‘å»ºè®®
- **åç«¯ä¿®æ”¹**: å…³æ³¨ `core/` æ¨¡å—çš„ä¸šåŠ¡é€»è¾‘ï¼Œç¡®ä¿åè®®è§£æå‡†ç¡®æ€§
- **å‰ç«¯ä¼˜åŒ–**: é‡ç‚¹å…³æ³¨ç”¨æˆ·ä½“éªŒå’ŒçŠ¶æ€ç®¡ç†çš„ä¸€è‡´æ€§
- **é…ç½®è°ƒæ•´**: ä¿®æ”¹é…ç½®æ—¶éœ€è¦åŒæ­¥æ›´æ–°æ–‡æ¡£å’Œéƒ¨ç½²è„šæœ¬
- **æµ‹è¯•è¦†ç›–**: æ–°åŠŸèƒ½å¿…é¡»æ·»åŠ ç›¸åº”çš„å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•

### å¸¸è§é—®é¢˜å¤„ç†
1. **åè®®è§£æå¤±è´¥**: æ£€æŸ¥ `parser.py` ä¸­çš„æ­£åˆ™è¡¨è¾¾å¼å’Œè§£æé€»è¾‘
2. **è½¬æ¢é…ç½®é”™è¯¯**: éªŒè¯ `converter.py` ä¸­çš„æ¨¡æ¿å’Œè§„åˆ™å¤„ç†
3. **å‰ç«¯çŠ¶æ€å¼‚å¸¸**: æ£€æŸ¥ Pinia store çš„çŠ¶æ€æ›´æ–°é€»è¾‘
4. **éƒ¨ç½²é—®é¢˜**: ç¡®è®¤ç¯å¢ƒå˜é‡é…ç½®å’Œå®¹å™¨ç½‘ç»œè¿æ¥
