# ============================================================
# 全新VPS环境变量配置 - news.guancn.me
# 用于全新VPS的完整部署配置
# ============================================================

# 项目信息
PROJECT_NAME=clash-converter
COMPOSE_PROJECT_NAME=clash-converter
ENVIRONMENT=production

# 域名配置
DOMAIN_NAME=news.guancn.me
SSL_EMAIL=admin@guancn.me
ENABLE_WWW_REDIRECT=true

# 端口配置 - 生产环境标准端口
BACKEND_PORT=8000           # 后端API端口
FRONTEND_PORT=3000          # 前端开发端口
NGINX_HTTP_PORT=80          # HTTP端口
NGINX_HTTPS_PORT=443        # HTTPS端口
MONITOR_PORT=9090           # 监控端口

# API配置
API_PREFIX=/api
BASE_URL=https://${DOMAIN_NAME}/api
FRONTEND_BASE_URL=https://${DOMAIN_NAME}

# 应用配置
APP_NAME=Clash订阅转换服务
APP_VERSION=2.0.0
APP_DEBUG=false
SECRET_KEY_FILE=/run/secrets/app_secret
JWT_SECRET_FILE=/run/secrets/jwt_secret

# 资源限制 - 生产环境优化
BACKEND_CPU_LIMIT=2.0
BACKEND_MEMORY_LIMIT=1g
BACKEND_CPU_RESERVE=0.5
BACKEND_MEMORY_RESERVE=512m
BACKEND_WORKERS=4

FRONTEND_CPU_LIMIT=1.0
FRONTEND_MEMORY_LIMIT=512m
FRONTEND_CPU_RESERVE=0.2
FRONTEND_MEMORY_RESERVE=256m

NGINX_CPU_LIMIT=0.5
NGINX_MEMORY_LIMIT=256m
NGINX_CPU_RESERVE=0.1
NGINX_MEMORY_RESERVE=128m

# Docker网络配置
NETWORK_NAME=clash-network
NETWORK_SUBNET=172.20.0.0/24
BRIDGE_NAME=clash-bridge

# 存储配置
APP_DATA_PATH=/opt/clash-converter/data
LOGS_PATH=/opt/clash-converter/logs
CONFIG_PATH=/opt/clash-converter/config
CACHE_PATH=/opt/clash-converter/cache
BACKUP_PATH=/opt/backups/clash-converter

# SSL证书配置
SSL_CERT_PATH=/etc/letsencrypt/live/${DOMAIN_NAME}/fullchain.pem
SSL_KEY_PATH=/etc/letsencrypt/live/${DOMAIN_NAME}/privkey.pem
SSL_DHPARAM_PATH=/etc/ssl/certs/dhparam.pem

# 安全配置
RUN_AS_USER=1000
RUN_AS_GROUP=1000
CONTAINER_SECURITY=true
READONLY_ROOT=true
NO_NEW_PRIVILEGES=true
DROP_ALL_CAPABILITIES=true

# 日志配置
LOG_LEVEL=INFO
LOG_FORMAT=json
LOG_MAX_SIZE=10m
LOG_MAX_FILES=5
LOG_DRIVER=json-file
ACCESS_LOG_ENABLED=true
ERROR_LOG_ENABLED=true

# 健康检查配置
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=10s
HEALTH_CHECK_RETRIES=3
HEALTH_CHECK_START_PERIOD=30s

# 性能配置
MAX_CONNECTIONS=1000
TIMEOUT_SECONDS=60
KEEPALIVE_TIMEOUT=65
CLIENT_MAX_BODY_SIZE=10m

# 构建参数
VITE_API_BASE_URL=https://${DOMAIN_NAME}/api
VITE_APP_ENV=production
VITE_APP_TITLE=${APP_NAME}
VITE_APP_VERSION=${APP_VERSION}
BUILD_TARGET=production

# 缓存配置
ENABLE_REDIS=false
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_DB=0
REDIS_PASSWORD=""
CACHE_TTL=3600

# 数据库配置（如果需要）
ENABLE_DATABASE=false
DB_HOST=localhost
DB_PORT=5432
DB_NAME=clash_converter
DB_USER=clash_user
DB_PASSWORD_FILE=/run/secrets/db_password

# 监控配置
METRICS_ENABLED=true
METRICS_PORT=${MONITOR_PORT}
METRICS_PATH=/metrics
ENABLE_PROMETHEUS=true
PROMETHEUS_SCRAPE_INTERVAL=30s

# 备份配置
BACKUP_ENABLED=true
BACKUP_SCHEDULE="0 2 * * *"
BACKUP_RETENTION_DAYS=30
BACKUP_COMPRESS=true
BACKUP_ENCRYPT=false

# 限流配置
RATE_LIMIT_ENABLED=true
RATE_LIMIT_REQUESTS=100
RATE_LIMIT_WINDOW=60
RATE_LIMIT_BURST=20

# 安全头配置
SECURITY_HEADERS_ENABLED=true
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=true
CSP_ENABLED=true
REFERRER_POLICY="strict-origin-when-cross-origin"

# CORS配置
CORS_ENABLED=true
CORS_ORIGINS="https://${DOMAIN_NAME},https://www.${DOMAIN_NAME}"
CORS_METHODS="GET,POST,PUT,DELETE,OPTIONS"
CORS_HEADERS="Origin,X-Requested-With,Content-Type,Accept,Authorization"

# Gzip压缩配置
GZIP_ENABLED=true
GZIP_COMPRESSION_LEVEL=6
GZIP_MIN_LENGTH=1024
GZIP_TYPES="text/plain,text/css,application/json,application/javascript,text/xml,application/xml,application/xml+rss,text/javascript"

# 时区和本地化
TZ=Asia/Shanghai
LOCALE=zh_CN.UTF-8
LANGUAGE=zh_CN

# 开发和调试
DEBUG_MODE=false
VERBOSE_LOGS=false
PROFILING_ENABLED=false
MAINTENANCE_MODE=false

# 第三方服务配置
SENTRY_DSN=""
ANALYTICS_ID=""

# 自定义配置
CUSTOM_CONFIG_PATH=/opt/clash-converter/config/custom.yaml
RULES_CONFIG_URL=""
SUBSCRIPTION_USER_AGENT="ClashConverter/2.0"

# Docker Compose覆盖
COMPOSE_FILE=docker-compose.yml:docker-compose.production.yml
COMPOSE_HTTP_TIMEOUT=300
COMPOSE_PARALLEL_LIMIT=10

# 系统配置
SYSTEM_TIMEZONE=${TZ}
SYSTEM_HOSTNAME=${DOMAIN_NAME}
SYSTEM_ADMIN_EMAIL=${SSL_EMAIL}